#!/usr/bin/env python3from fastapi import FastAPI, HTTPException, Depends, BackgroundTasksfrom fastapi.middleware.cors import CORSMiddlewarefrom pydantic import BaseModel, EmailStr, Fieldfrom sqlalchemy import Column, Integer, String, Float, DateTime, Boolean, create_engine, func, desc, Textfrom sqlalchemy.orm import declarative_base, sessionmaker, Sessionfrom sqlalchemy.exc import IntegrityErrorimport os, logging, stripe, json, smtplibfrom datetime import datetime, timedeltafrom typing import Optional, Listfrom email.mime.text import MIMETextfrom email.mime.multipart import MIMEMultipart
