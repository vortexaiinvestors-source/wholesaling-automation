import express from 'express';import cors from 'cors';import dotenv from 'dotenv';import { Pool } from 'pg';dotenv.config();const app = express();const port = process.env.PORT || 3000;const pool = new Pool({connectionString: process.env.DATABASE_URL});app.use(cors());app.use(express.json());app.get('/health',(req,res)=>{res.json({status:'ok',timestamp:new Date().toISOString()})});app.get('/api/health/db',async(req,res)=>{try{const result=await pool.query('SELECT NOW()');res.json({status:'ok',database:'connected',timestamp:result.rows[0].now})}catch(error){res.status(500).json({status:'error',database:'disconnected',error:error.message})}});app.get('/api/deals',async(req,res)=>{try{const result=await pool.query('SELECT * FROM deals LIMIT 50');res.json({success:true,count:result.rowCount,deals:result.rows})}catch(error){res.status(500).json({success:false,error:error.message})}});app.get('/api/buyers',async(req,res)=>{try{const result=await pool.query('SELECT * FROM buyers LIMIT 50');res.json({success:true,count:result.rowCount,buyers:result.rows})}catch(error){res.status(500).json({success:false,error:error.message})}});app.post('/api/deals',async(req,res)=>{const{title,description,asset_category_id,asking_price,estimated_arv,location}=req.body;try{const result=await pool.query('INSERT INTO deals (title,description,asset_category_id,asking_price,estimated_arv,location,deal_status) VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING *',[title,description,asset_category_id,asking_price,estimated_arv,location,'new']);res.status(201).json({success:true,deal:result.rows[0]})}catch(error){res.status(500).json({success:false,error:error.message})}});app.post('/api/buyers',async(req,res)=>{const{name,email,phone,preferred_asset_types,budget_min,budget_max}=req.body;try{const result=await pool.query('INSERT INTO buyers (name,email,phone,preferred_asset_types,budget_min,budget_max,status) VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING *',[name,email,phone,preferred_asset_types,budget_min,budget_max,'active']);res.status(201).json({success:true,buyer:result.rows[0]})}catch(error){res.status(500).json({success:false,error:error.message})}});app.listen(port,()=>{console.log(`VortexAI Backend running on port ${port}`);console.log(`Health check: http://localhost:${port}/health`);console.log(`DB Health: http://localhost:${port}/api/health/db`)});